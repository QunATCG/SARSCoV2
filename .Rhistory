pie <- pie + scale_fill_manual(values=c("#CD2626", "#B8860B", "#E69F00", "#56B4E9", "#EED8AE", "#708090"))
# blank theme
blank_theme <- theme_minimal()+
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=14, face="bold")
)
pie <- pie + blank_theme
pie <- pie + theme(axis.text.x=element_blank())+
geom_text(aes(y = value/6 + c(0, cumsum(value)[-length(value)]),
label = percent(value/100)), size=5)
pie
rm(list = ls())
library(ggplot2)
library(scales)
df <- data.frame(
group = c("syn", "lof", "mis-D", "mis-P", "mis-B", "mis-unknown"),
value = c(136, 72, 173, 61, 122, 4)
)
head(df)
bp <- ggplot(df, aes(x="", y=value, fill=group)) +
geom_bar(width = 1, stat = "identity")
pie <- bp + coord_polar("y", start = 0)
# color settings
pie <- pie + scale_fill_manual(values=c("#CD2626", "#B8860B", "#E69F00", "#56B4E9", "#EED8AE", "#708090"))
# blank theme
blank_theme <- theme_minimal()+
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=14, face="bold")
)
pie <- pie + blank_theme
pie <- pie + theme(axis.text.x=element_blank())
pie
rm(list = ls())
library(ggplot2)
library(scales)
df <- data.frame(
group = c("syn", "lof", "mis-1D", "mis-2P", "mis-3B", "mis-4unknown"),
value = c(136, 72, 173, 61, 122, 4)
)
head(df)
bp <- ggplot(df, aes(x="", y=value, fill=group)) +
geom_bar(width = 1, stat = "identity")
pie <- bp + coord_polar("y", start = 0)
# color settings
pie <- pie + scale_fill_manual(values=c("#CD2626", "#87CEEB", "#E69F00", "#56B4E9", "#EED8AE", "#708090"))
# blank theme
blank_theme <- theme_minimal()+
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=14, face="bold")
)
pie <- pie + blank_theme
pie <- pie + theme(axis.text.x=element_blank())
pie
rm(list = ls())
library(ggplot2)
library(scales)
df <- data.frame(
group = c("syn", "lof", "mis-1D", "mis-2P", "mis-3B", "mis-4unknown"),
value = c(136, 72, 173, 61, 122, 4)
)
head(df)
bp <- ggplot(df, aes(x="", y=value, fill=group)) +
geom_bar(width = 1, stat = "identity")
pie <- bp + coord_polar("y", start = 0)
# color settings
pie <- pie + scale_fill_manual(values=c("#CD2626", "#0000FF", "#1E90FF", "#4682B4", "#EED8AE", "#708090"))
# blank theme
blank_theme <- theme_minimal()+
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=14, face="bold")
)
pie <- pie + blank_theme
pie <- pie + theme(axis.text.x=element_blank())
pie
rm(list = ls())
library(ggplot2)
library(scales)
df <- data.frame(
group = c("syn", "lof", "mis-1D", "mis-2P", "mis-3B", "mis-4unknown"),
value = c(136, 72, 173, 61, 122, 4)
)
head(df)
bp <- ggplot(df, aes(x="", y=value, fill=group)) +
geom_bar(width = 1, stat = "identity")
pie <- bp + coord_polar("y", start = 0)
# color settings
pie <- pie + scale_fill_manual(values=c("#CD2626", "#0000FF", "#009ACD", "#4682B4", "#EED8AE", "#708090"))
# blank theme
blank_theme <- theme_minimal()+
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=14, face="bold")
)
pie <- pie + blank_theme
pie <- pie + theme(axis.text.x=element_blank())
pie
rm(list = ls())
library(ggplot2)
library(scales)
df <- data.frame(
group = c("syn", "lof", "mis-1D", "mis-2P", "mis-3B", "mis-4unknown"),
value = c(136, 72, 173, 61, 122, 4)
)
head(df)
bp <- ggplot(df, aes(x="", y=value, fill=group)) +
geom_bar(width = 1, stat = "identity")
pie <- bp + coord_polar("y", start = 0)
# color settings
pie <- pie + scale_fill_manual(values=c("#FF6347", "#0000FF", "#009ACD", "#4682B4", "#EED8AE", "#708090"))
# blank theme
blank_theme <- theme_minimal()+
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=14, face="bold")
)
pie <- pie + blank_theme
pie <- pie + theme(axis.text.x=element_blank())
pie
rm(list = ls())
library(ggplot2)
library(scales)
df <- data.frame(
group = c("syn", "lof", "mis-1D", "mis-2P", "mis-3B", "mis-4unknown"),
value = c(136, 72, 173, 61, 122, 4)
)
head(df)
bp <- ggplot(df, aes(x="", y=value, fill=group)) +
geom_bar(width = 1, stat = "identity")
pie <- bp + coord_polar("y", start = 0)
# color settings
pie <- pie + scale_fill_manual(values=c("#FF6347", "#483D8B", "#6A5ACD", "#7B68EE", "#8470FF", "#708090"))
# blank theme
blank_theme <- theme_minimal()+
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=14, face="bold")
)
pie <- pie + blank_theme
pie <- pie + theme(axis.text.x=element_blank())
pie
rm(list = ls())
library(ggplot2)
library(scales)
df <- data.frame(
group = c("syn", "lof", "mis-1D", "mis-2P", "mis-3B", "mis-4unknown"),
value = c(136, 72, 173, 61, 122, 4)
)
head(df)
bp <- ggplot(df, aes(x="", y=value, fill=group)) +
geom_bar(width = 1, stat = "identity")
pie <- bp + coord_polar("y", start = 0)
# color settings
pie <- pie + scale_fill_manual(values=c("#FF6347", "#483D8B", "#6A5ACD", "#7B68EE", "#008B00", "#708090"))
# blank theme
blank_theme <- theme_minimal()+
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=14, face="bold")
)
pie <- pie + blank_theme
pie <- pie + theme(axis.text.x=element_blank())
pie
rm(list = ls())
library(ggplot2)
library(scales)
df <- data.frame(
group = c("syn", "lof", "mis-1D", "mis-2P", "mis-3B", "mis-4unknown"),
value = c(136, 72, 173, 61, 122, 4)
)
head(df)
bp <- ggplot(df, aes(x="", y=value, fill=group)) +
geom_bar(width = 1, stat = "identity")
pie <- bp + coord_polar("y", start = 0)
# color settings
pie <- pie + scale_fill_manual(values=c("#FF6347", "#3f007d", "#6a51a3", "#9e9ac8", "#dadaeb", "#708090"))
# blank theme
blank_theme <- theme_minimal()+
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=14, face="bold")
)
pie <- pie + blank_theme
pie <- pie + theme(axis.text.x=element_blank())
pie
rm(list = ls())
library(ggplot2)
library(scales)
df <- data.frame(
group = c("syn", "lof", "mis-1D", "mis-2P", "mis-3B", "mis-4unknown"),
value = c(136, 72, 173, 61, 122, 4)
)
head(df)
bp <- ggplot(df, aes(x="", y=value, fill=group)) +
geom_bar(width = 1, stat = "identity")
pie <- bp + coord_polar("y", start = 0)
# color settings
pie <- pie + scale_fill_manual(values=c("#7f0000", "#3f007d", "#6a51a3", "#9e9ac8", "#dadaeb", "#708090"))
# blank theme
blank_theme <- theme_minimal()+
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=14, face="bold")
)
pie <- pie + blank_theme
pie <- pie + theme(axis.text.x=element_blank())
pie
df <- data.frame(c(15, 1229-15),c( 2,2800-2))
df
fisher.test(df)
df <- matrix(c(15, 1229-15, 2,2800-2), nrow=2)
df
fisher.test(df, alternative="greater")
df <- matrix(c(15, 1229-15, 2,2813-2), nrow=2)
fisher.test(df, alternative="greater")
df <- matrix(c(15, 2000-15, 2,2813-2), nrow=2)
fisher.test(df, alternative="greater")
df
df <- matrix(c(15, 3000-15, 2,2813-2), nrow=2)
fisher.test(df, alternative="greater")
df <- matrix(c(15, 1619-15, 2,2813-2), nrow=2)
fisher.test(df, alternative="greater")
df <- matrix(c(15, 1219-15, 2,2813-2), nrow=2)
fisher.test(df, alternative="greater")
a <- c(1,2)
b <- c(30,5)
data = matrix(c(a,b))
data
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "greater")
fisher.test(data, alternative = "two.side")
n_lof_dyrk1a <- 3
prob_lof_dyrk1a <- 2.528297e-06
n_trios <- 1078
ppois(q=n_lof_dyrk1a-1, #observed - 1
ppois(q=n_lof_dyrk1a-1, #observed - 1
lambda=prob_lof_dyrk1a*n_trios*2, #expected
lower.tail=FALSE)
ppois(q=n_lof_dyrk1a-1, #observed - 1
lambda=prob_lof_dyrk1a*n_trios*2, #expected
lower.tail=FALSE)
poisson.test(3, prob_lof_dyrk1a*n_trios*2,1,alternative=c('two.sided'))
fisher.test(data, alternative = "two.side")
data
a <- c(1219,12)
b <- c(2813,0)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "two.side")
postest=poisson.test(559,547.7,alternative=c("two.side"),conf.level = 0.95)
postest$p.value
postest$conf.int
##################################################
# library
{
library(denovolyzeR)
library(ggplot2)
}
controlgene = read.table("./controldenovogeneClass.txt",sep = "\t", header = T)
controlgene = read.table("/Users/liqun/QunJob/Denovo/2_enrichmentPlot/Code/controldenovogeneClass.txt",sep = "\t", header = T)
ControlClass = denovolyzeByClass(genes=controlgene$Gene,
classes=controlgene$GeneClass,
nsamples=103)
ControlClass
postest=poisson.test(9,9,alternative=c("two.side"),conf.level = 0.95)
postest$p.value
postest$conf.int
a <- c(1219,12)
b <- c(2813,2)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "two.side")
fisher.test(data, alternative = "greater")
a <- c(1219,12)
b <- c(2813,2)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "greater")
a <- c(12,1219-12)
b <- c(2,2813-2)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "two.side")
fisher.test(data, alternative = "greater")
data
data
fisher.test(data, alternative = "two.side")
fisher.test(data, alternative = "two.side", conf.int = TRUE)
fisher.test(data, alternative = "two.side", conf.int = TRUE, conf.level = 0.99)
fisher.test(data, alternative = "two.side", conf.int = TRUE, conf.level = 0.90)
fisher.test(data, alternative = "two.side", conf.int = TRUE, conf.level = 0.95)
chisq.test(data)
n_lof_dyrk1a <- 3
prob_lof_dyrk1a <- 2.528297e-06
n_trios <- 1078
ppois(q=n_lof_dyrk1a-1, #observed - 1
lambda=prob_lof_dyrk1a*n_trios*2, #expected
lower.tail=FALSE)
poisson.test(3, prob_lof_dyrk1a*n_trios*2,1,alternative=c('two.sided'))
a <- c(12,n_case-12)
b <- c(8,n_control-8)
data = matrix(c(a,b), nrow = 2)
data
n_case = 716
n_control = 3539
a <- c(12,n_case-12)
b <- c(8,n_control-8)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "greater")
a <- c(6,n_case-6)
b <- c(8,n_control-8)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "greater")
n_case = 716
n_control = 3539
case = 23
control = 35
a <- c(case,n_case-case)
b <- c(control,n_control-control)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "greater")
case = 15
control = 35
a <- c(case,n_case-case)
b <- c(control,n_control-control)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "greater")
case = 20
control = 27
a <- c(case,n_case-case)
b <- c(control,n_control-control)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "greater")
case = 15
control = 27
a <- c(case,n_case-case)
b <- c(control,n_control-control)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "greater")
case = 15
control = 17
a <- c(case,n_case-case)
b <- c(control,n_control-control)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "greater")
case = 11
control = 17
a <- c(case,n_case-case)
b <- c(control,n_control-control)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "greater")
a <- c(9,716-9)
b <- c(24,3539-4)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "greater")
a <- c(7,716-7)
b <- c(0,3539-0)
data = matrix(c(a,b), nrow = 2)
data
fisher.test(data, alternative = "greater")
fisher.test(data, alternative = "greater")$pvalue
fisher.test(data, alternative = "greater")$p-value
fisher.test(data, alternative = "greater")$p.value
library(RUVSeq)
install.packages("RUVSeq")
BiocManager::install("RUVSeq")
library(RUVSeq)
200000*25000
R
library(DESeq2)
packageVersion('DESeq2')
packageVersion('pheatmap')
# set working env
rm(list = ls())
dirNow <- getwd()
# set working env
rm(list = ls())
# check your working path
dirNow <- getwd()
# set your working path
setwd("/Users/liqun/Desktop/Projects/Covid19/Data/Code/SARSCoV2/")
# load libraries
library(DESeq2)
library(pheatmap)
# load tpm and matchedID
expTPM <- read.table("../Data/ExpRNAseq/Covid19.gene.tpm", header = T,
sep = "\t", stringsAsFactors = FALSE)
# check your working path
dirNow <- getwd()
# load tpm and matchedID
expTPM <- read.table("./Data/ExpRNAseq/Covid19.gene.tpm", header = T,
sep = "\t", stringsAsFactors = FALSE)
View(expTPM)
matchedID <- read.table("./Data/matchedID.txt", header = T, sep = "\t",
stringsAsFactors = FALSE)
View(matchedID)
matchedID[1,]
matchedID[1,]$Gene
View(matchedID)
matchedID[39,]$Gene
matchedID[39,]$Gene == ""
# process NA items of matchedID
for (i in 1:nrow(matchedID)){
if (matchedID[i,]$Gene == ""){
matchedID[i,]$Gene = matchedID[i,]$Ensembl
}
}
View(matchedID)
colnames(expTPM)
View(expTPM)
sampleInfo <- read.table("./Data/Sample_information.txt", header = T,
sep = "\t", stringsAsFactors = FALSE)
View(sampleInfo)
sampleInfo <- read.table("./Data/Sample_information.txt", header = F,
sep = "\t", stringsAsFactors = FALSE)
colnames(expTPM)
sampleInfo
# rename the colnames of expTPM
colNamesExp <- c("Ensembl",sampleInfo$V2)
colnames(expTPM) <- colNamesExp
View(expTPM)
sampleInfo <- read.table("./Data/Sample_information.txt", header = T,
sep = "\t", stringsAsFactors = FALSE)
# rename the colnames of expTPM
colNamesExp <- c("Ensembl",sampleInfo$InfoTag)
colnames(expTPM) <- colNamesExp
View(expTPM)
# match Ensembl and Gene
expData <- merge(expTPM, matchedID, by = "Ensembl", all.x = T)
View(expData)
# set working env
rm(list = ls())
# set your working path
setwd("/Users/liqun/Desktop/Projects/Covid19/Data/Code/SARSCoV2/")
# check your working path
dirNow <- getwd()
# load libraries
library(DESeq2)
library(pheatmap)
# load tpm, matchedID and sampleinfo
expTPM <- read.table("./Data/ExpRNAseq/Covid19.gene.tpm", header = T,
sep = "\t", stringsAsFactors = FALSE)
matchedID <- read.table("./Data/matchedID.txt", header = T, sep = "\t",
stringsAsFactors = FALSE)
sampleInfo <- read.table("./Data/Sample_information.txt", header = T,
sep = "\t", stringsAsFactors = FALSE)
# process NA items of matchedID
for (i in 1:nrow(matchedID)){
if (matchedID[i,]$Gene == ""){
matchedID[i,]$Gene = matchedID[i,]$Ensembl
}
}
# rename the colnames of expTPM
colNamesExp <- c("Ensembl",sampleInfo$InfoTag)
colnames(expTPM) <- colNamesExp
# match Ensembl and Gene
expData <- merge(expTPM, matchedID, by = "Ensembl", all.x = T)
View(expData)
View(sampleInfo)
