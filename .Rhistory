# set working env
rm(list = ls())
# set your working path
setwd("/Users/liqun/Desktop/Projects/Covid19/Data/Code/SARSCoV2/")
# check your working path
dirNow <- getwd()
# load libraries
library(DESeq2)
library(pheatmap)
# load tpm, matchedID and sampleinfo
expTPM <- read.table("./Data/ExpRNAseq/Covid19.gene.tpm", header = T,
sep = "\t", stringsAsFactors = FALSE)
matchedID <- read.table("./Data/matchedID.txt", header = T, sep = "\t",
stringsAsFactors = FALSE)
sampleInfo <- read.table("./Data/Sample_information.txt", header = T,
sep = "\t", stringsAsFactors = FALSE)
# process NA items of matchedID
for (i in 1:nrow(matchedID)){
if (matchedID[i,]$Gene == ""){
matchedID[i,]$Gene = matchedID[i,]$Ensembl
}
}
# rename the colnames of expTPM
colNamesExp <- c("Ensembl",sampleInfo$InfoTag)
colnames(expTPM) <- colNamesExp
# match Ensembl and Gene
expData <- merge(expTPM, matchedID, by = "Ensembl", all.x = T)
# rename the colnames of expTPM
colNamesExp <- paste(c("Ensembl",sampleInfo$InfoTag),"TPM", sep = "_")
expCount <- read.table("./Data/ExpRNAseq/Covid19.gene.count", header = T,
sep = "\t", stringsAsFactors = FALSE)
View(expCount)
colNamesCount <- paste(c("Ensembl",sampleInfo$InfoTag),"Count", sep = "_")
colnames(expCount) <- colNamesCount
# rename the colnames of expTPM
colNamesExp <- c("Ensembl",paste(c(sampleInfo$InfoTag),"TPM", sep = "_"))
colNamesCount <- c("Ensembl",paste(c(sampleInfo$InfoTag),"Count", sep = "_"))
colnames(expTPM) <- colNamesExp
colnames(expCount) <- colNamesCount
# set working env
rm(list = ls())
# set working env
rm(list = ls())
# set your working path
setwd("/Users/liqun/Desktop/Projects/Covid19/Data/Code/SARSCoV2/")
# check your working path
dirNow <- getwd()
# load libraries
library(DESeq2)
library(pheatmap)
# load tpm, matchedID and sampleinfo
expTPM <- read.table("./Data/ExpRNAseq/Covid19.gene.tpm", header = T,
sep = "\t", stringsAsFactors = FALSE)
expCount <- read.table("./Data/ExpRNAseq/Covid19.gene.count", header = T,
sep = "\t", stringsAsFactors = FALSE)
matchedID <- read.table("./Data/matchedID.txt", header = T, sep = "\t",
stringsAsFactors = FALSE)
sampleInfo <- read.table("./Data/Sample_information.txt", header = T,
sep = "\t", stringsAsFactors = FALSE)
# process NA items of matchedID
for (i in 1:nrow(matchedID)){
if (matchedID[i,]$Gene == ""){
matchedID[i,]$Gene = matchedID[i,]$Ensembl
}
}
# rename the colnames of expTPM
colNamesExp <- c("Ensembl",paste(c(sampleInfo$InfoTag),"TPM", sep = "_"))
colNamesCount <- c("Ensembl",paste(c(sampleInfo$InfoTag),"Count", sep = "_"))
colnames(expTPM) <- colNamesExp
colnames(expCount) <- colNamesCount
# match Ensembl and Gene
expDataTPM <- merge(expTPM, matchedID, by = "Ensembl", all.x = T)
expDataTPMCount <- merge(expDataTPM, expCount, by = "Ensembl", all.x = T)
View(expDataTPMCount)
expData <- expDataTPMCount
ls
# set working env
rm(list = ls())
# set your working path
setwd("/Users/liqun/Desktop/Projects/Covid19/Data/Code/SARSCoV2/")
# check your working path
dirNow <- getwd()
# load libraries
library(DESeq2)
library(pheatmap)
# load tpm, matchedID and sampleinfo
expTPM <- read.table("./Data/ExpRNAseq/Covid19.gene.tpm", header = T,
sep = "\t", stringsAsFactors = FALSE)
expCount <- read.table("./Data/ExpRNAseq/Covid19.gene.count", header = T,
sep = "\t", stringsAsFactors = FALSE)
matchedID <- read.table("./Data/matchedID.txt", header = T, sep = "\t",
stringsAsFactors = FALSE)
sampleInfo <- read.table("./Data/Sample_information.txt", header = T,
sep = "\t", stringsAsFactors = FALSE)
# process NA items of matchedID
for (i in 1:nrow(matchedID)){
if (matchedID[i,]$Gene == ""){
matchedID[i,]$Gene = matchedID[i,]$Ensembl
}
}
# rename the colnames of expTPM
colNamesExp <- c("Ensembl",paste(c(sampleInfo$InfoTag),"TPM", sep = "_"))
colNamesCount <- c("Ensembl",paste(c(sampleInfo$InfoTag),"ExpectedCount", sep = "_"))
colnames(expTPM) <- colNamesExp
colnames(expCount) <- colNamesCount
# match Ensembl and Gene
expDataTPM <- merge(expTPM, matchedID, by = "Ensembl", all.x = T)
expDataTPMCount <- merge(expDataTPM, expCount, by = "Ensembl", all.x = T)
expData <- expDataTPMCount
View(expData)
# set working env
rm(list = ls())
# set your working path
setwd("/Users/liqun/Desktop/Projects/Covid19/Data/Code/SARSCoV2/")
# check your working path
dirNow <- getwd()
# load libraries
library(DESeq2)
library(pheatmap)
# load tpm, matchedID and sampleinfo
expTPM <- read.table("./Data/ExpRNAseq/Covid19.gene.tpm", header = T,
sep = "\t", stringsAsFactors = FALSE)
expFPKM <- read.table("./Data/ExpRNAseq/Covid19.gene.fpkm", header = T,
sep = "\t", stringsAsFactors = FALSE)
expExpextedCount <- read.table("./Data/ExpRNAseq/Covid19.gene.count", header = T,
sep = "\t", stringsAsFactors = FALSE)
matchedID <- read.table("./Data/matchedID.txt", header = T, sep = "\t",
stringsAsFactors = FALSE)
sampleInfo <- read.table("./Data/Sample_information.txt", header = T,
sep = "\t", stringsAsFactors = FALSE)
# process NA items of matchedID
for (i in 1:nrow(matchedID)){
if (matchedID[i,]$Gene == ""){
matchedID[i,]$Gene = matchedID[i,]$Ensembl
}
}
# set working env
rm(list = ls())
# set your working path
setwd("/Users/liqun/Desktop/Projects/Covid19/Data/Code/SARSCoV2/")
# check your working path
dirNow <- getwd()
# load libraries
library(DESeq2)
library(pheatmap)
# load tpm, matchedID and sampleinfo
expTPM <- read.table("./Data/ExpRNAseq/Covid19.gene.tpm", header = T,
sep = "\t", stringsAsFactors = FALSE)
expFPKM <- read.table("./Data/ExpRNAseq/Covid19.gene.fpkm", header = T,
sep = "\t", stringsAsFactors = FALSE)
expExpextedCount <- read.table("./Data/ExpRNAseq/Covid19.gene.count", header = T,
sep = "\t", stringsAsFactors = FALSE)
matchedID <- read.table("./Data/matchedID.txt", header = T, sep = "\t",
stringsAsFactors = FALSE)
sampleInfo <- read.table("./Data/Sample_information.txt", header = T,
sep = "\t", stringsAsFactors = FALSE)
# process NA items of matchedID
for (i in 1:nrow(matchedID)){
if (matchedID[i,]$Gene == ""){
matchedID[i,]$Gene = matchedID[i,]$Ensembl
}
}
# rename the colnames of expTPM
colNamesTPM <- c("Ensembl",paste(c(sampleInfo$InfoTag),"TPM", sep = "_"))
colNamesFPKM <- c("Ensembl",paste(c(sampleInfo$InfoTag),"FPKM", sep = "_"))
colNamesExpectedCount <- c("Ensembl",paste(c(sampleInfo$InfoTag),"ExpectedCount", sep = "_"))
colnames(expTPM) <- colNamesTPM
colnames(expFPKM) <- colNamesFPKM
colnames(expExpextedCount) <- colNamesCount
colnames(expExpextedCount) <- colNamesExpectedCount
# match Ensembl and Gene
expDataTPM <- merge(expTPM, matchedID, by = "Ensembl", all.x = T)
expDataTPM_FPKM <- merge(expDataTPM, expFPKM, by = "Ensembl", all.x = T)
expDataTPM_FPKM_ExpectedCount <- merge(expDataTPM_FPKM, expExpextedCount, by = "Ensembl", all.x = T)
View(expDataTPM_FPKM_ExpectedCount)
