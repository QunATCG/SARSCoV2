library(venneuler)
# env setting
{
# set working env
rm(list = ls())
# set your working path
setwd("/Users/liqun/Desktop/Projects/Covid19/Data/Code/SARSCoV2/")
# check your working path
dirNow <- getwd()
}
# libraries
{
library(pheatmap)
library(cowplot)
library(org.Hs.eg.db)
library(reshape2)
library(clusterProfiler)
library(ggplot2)
library(gplots)
library(ggrepel)
library(ggsci)
library(ggpubr)
library(UpSetR)
source("./Code/basicFunction.R")
}
# load data
{
# Ensembl-gene pair
Ensembl_gene <- read.table("./Data/SourceData/matchedID.txt", header = T, sep = "\t")
# Expression
# exp this study
{
exp_total <- read.table("./Data/ExpRNAseq/exp_Data_merge.txt", header = T, sep = "\t")
exp_fpkm <- exp_total[,c(1,11:20)]
exp_fpkm_scale <- t(scale(t(exp_fpkm[,c(3:11)])))
exp_fpkm <- cbind(exp_fpkm[,c(1,2)], exp_fpkm_scale)
exp_fpkm$Mock_mean_scale <- apply(exp_fpkm[,3:5], 1, mean)
exp_fpkm$NT_mean_scale <- apply(exp_fpkm[,6:8], 1, mean)
exp_fpkm$T_mean_scale <- apply(exp_fpkm[,9:11], 1, mean)
}
# DEG table
{
deg_mock_nt_total <- read.table("./Results/Table/DEG/DE_Data_Mock_NT.txt", header = T, sep = "\t")
deg_mock_t_total <- read.table("./Results/Table/DEG/DE_Data_Mock_T.txt", header = T, sep = "\t")
deg_nt_t_total <- read.table("./Results/Table/DEG/DE_Data_NT_T.txt", header = T, sep = "\t")
}
# load public exp
{
exp_GSE150316 <- read.table("./Results/Table/PublicExp/exp_GSE150316_scale.txt", header = T, sep = "\t")
exp_GSE152418 <- read.table("./Results/Table/PublicExp/exp_GSE152418_scale.txt", header = T, sep = "\t")
exp_GSE157103 <- read.table("./Results/Table/PublicExp/exp_GSE157103_scale.txt", header = T, sep = "\t")
}
}
targetGene <- "IFIT1"
p_1 <- qunplotboxgenes(targetGene, exp_fpkm, myComparision = list(c("Mock", "NT"),c("Mock","T"), c("NT", "T")),myColors = c("grey", "Dark Red", "Brown"), isThisStudy = "T")
p_1
p_2 <- qunplotboxgenes(targetGene, exp_GSE150316, myComparision = list(c("NC", "Case")),myColors = c("grey", "Dark Red", "#fcbba1", "#fc9272"), isThisStudy = "316")
p_2
p_3 <- qunplotboxgenes(targetGene, exp_GSE152418, myComparision = list(c("NC", "Case")),myColors = c("grey", "Dark Red", "Brown"), isThisStudy = "F")
p_3
p_4 <- qunplotboxgenes(targetGene, exp_GSE157103, myComparision = list(c("NC", "Case")),myColors = c("grey", "Dark Red", "Brown"), isThisStudy = "F")
p_4
targetGene <- "IFIT2"
p_1 <- qunplotboxgenes(targetGene, exp_fpkm, myComparision = list(c("Mock", "NT"),c("Mock","T"), c("NT", "T")),myColors = c("grey", "Dark Red", "Brown"), isThisStudy = "T")
p_1
p_2 <- qunplotboxgenes(targetGene, exp_GSE150316, myComparision = list(c("NC", "Case")),myColors = c("grey", "Dark Red", "#fcbba1", "#fc9272"), isThisStudy = "316")
p_2
plot_grid(p_1, p_2, ncol = 2)
p_3 <- qunplotboxgenes(targetGene, exp_GSE152418, myComparision = list(c("NC", "Case")),myColors = c("grey", "Dark Red", "Brown"), isThisStudy = "F")
p_3
p_4 <- qunplotboxgenes(targetGene, exp_GSE157103, myComparision = list(c("NC", "Case")),myColors = c("grey", "Dark Red", "Brown"), isThisStudy = "F")
p_4
targetGene <- "IFIT3"
p_1 <- qunplotboxgenes(targetGene, exp_fpkm, myComparision = list(c("Mock", "NT"),c("Mock","T"), c("NT", "T")),myColors = c("grey", "Dark Red", "Brown"), isThisStudy = "T")
p_1
p_2 <- qunplotboxgenes(targetGene, exp_GSE150316, myComparision = list(c("NC", "Case")),myColors = c("grey", "Dark Red", "#fcbba1", "#fc9272"), isThisStudy = "316")
p_2
plot_grid(p_1, p_2, ncol = 2)
p_3 <- qunplotboxgenes(targetGene, exp_GSE152418, myComparision = list(c("NC", "Case")),myColors = c("grey", "Dark Red", "Brown"), isThisStudy = "F")
p_3
p_4 <- qunplotboxgenes(targetGene, exp_GSE157103, myComparision = list(c("NC", "Case")),myColors = c("grey", "Dark Red", "Brown"), isThisStudy = "F")
p_4
